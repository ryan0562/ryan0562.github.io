(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{502:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"使用指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用指南"}},[t._v("#")]),t._v(" 使用指南")]),t._v(" "),s("blockquote",[s("p",[t._v("除通用的使用指南外，你可能还想通过"),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/index.zh_CN.html"}},[t._v("场景示例")]),t._v("了解特定场景下的使用方式，或是通过"),s("a",{attrs:{href:"./docs"}},[t._v("设计文档")]),t._v("深入 rrweb 的技术细节。")],1)]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("h3",{attrs:{id:"直接通过-script-引入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#直接通过-script-引入"}},[t._v("#")]),t._v(" 直接通过 "),s("code",[t._v("<script>")]),t._v(" 引入")]),t._v(" "),s("p",[t._v("推荐通过 jsdelivr 的 CDN 安装：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.css"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("也可以在 URL 中指定具体的版本号，例如：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb@0.7.0/dist/rrweb.min.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h4",{attrs:{id:"仅引入录制部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#仅引入录制部分"}},[t._v("#")]),t._v(" 仅引入录制部分")]),t._v(" "),s("p",[t._v("rrweb 代码分为录制和回放两部分，大多数时候用户在被录制的应用中只需要引入录制部分代码，同样可以通过 CDN 安装：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb@latest/dist/record/rrweb-record.min.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h4",{attrs:{id:"其它按需引入方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其它按需引入方式"}},[t._v("#")]),t._v(" 其它按需引入方式")]),t._v(" "),s("p",[t._v("除了仅包含录制代码的 "),s("code",[t._v("record/rrweb-record-min.js")]),t._v(" 之外，rrweb 还提供了其它多种可选的打包文件。所有包含 "),s("code",[t._v(".min")]),t._v(" 的文件为同名文件的压缩版。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包含录制、回放、压缩数据、解压缩数据")]),t._v("\nrrweb-all.js\nrrweb-all.min.js\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包含录制、回放")]),t._v("\nrrweb.js\nrrweb.min.js\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 回放所需的样式文件")]),t._v("\nrrweb.min.css\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 录制")]),t._v("\nrecord/rrweb-record.js\nrecord/rrweb-record.min.js\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩数据")]),t._v("\nrecord/rrweb-record-pack.js\nrecord/rrweb-record-pack.min.js\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 回放")]),t._v("\nreplay/rrweb-replay.js\nreplay/rrweb-replay.min.js\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解压缩数据")]),t._v("\nreplay/rrweb-replay-unpack.js\nreplay/rrweb-replay-unpack.min.js\n")])])]),s("h3",{attrs:{id:"通过-npm-引入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过-npm-引入"}},[t._v("#")]),t._v(" 通过 npm 引入")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--save")]),t._v(" rrweb\n")])])]),s("p",[t._v("rrweb 同时提供 commonJS 和 ES modules 两种格式的打包文件，易于和常见的打包工具配合使用。")]),t._v(" "),s("h3",{attrs:{id:"兼容性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#兼容性"}},[t._v("#")]),t._v(" 兼容性")]),t._v(" "),s("p",[t._v("由于使用 "),s("code",[t._v("MutationObserver")]),t._v(" API，rrweb 不支持 IE11 以下的浏览器。可以从"),s("a",{attrs:{href:"https://caniuse.com/#feat=mutationobserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("找到兼容的浏览器列表。")]),t._v(" "),s("h2",{attrs:{id:"快速开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速开始"}},[t._v("#")]),t._v(" 快速开始")]),t._v(" "),s("h3",{attrs:{id:"录制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#录制"}},[t._v("#")]),t._v(" 录制")]),t._v(" "),s("p",[t._v("如果通过 "),s("code",[t._v("<script>")]),t._v(" 的方式仅引入录制部分，那么可以访问到全局变量 "),s("code",[t._v("rrwebRecord")]),t._v("，它和全量引入时的 "),s("code",[t._v("rrweb.record")]),t._v(" 使用方式完全一致，以下示例代码将使用后者。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("rrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用任意方式存储 event")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("rrweb 在录制时会不断将各类 event 传递给配置的 emit 方法，你可以使用任何方式存储这些 event 以便之后回放。")]),t._v(" "),s("p",[t._v("调用 "),s("code",[t._v("record")]),t._v(" 方法将返回一个函数，调用该函数可以终止录制：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" stopFn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当事件数量大于 100 时停止录制")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stopFn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("一个更接近实际真实使用场景的示例如下：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nrrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将 event 存入 events 数组中")]),t._v("\n    events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// save 函数用于将 events 发送至后端存入，并重置 events 数组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://YOUR_BACKEND_API'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每 10 秒调用一次 save 方法，避免请求过多")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInterval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"配置参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置参数"}},[t._v("#")]),t._v(" 配置参数")]),t._v(" "),s("p",[s("code",[t._v("rrweb.record(config)")]),t._v(" 的 config 部分接受以下参数")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("key")]),t._v(" "),s("th",[t._v("默认值")]),t._v(" "),s("th",[t._v("功能")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("emit")]),t._v(" "),s("td",[t._v("必填")]),t._v(" "),s("td",[t._v("获取当前录制的数据")])]),t._v(" "),s("tr",[s("td",[t._v("checkoutEveryNth")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("每 N 次事件重新制作一次全量快照"),s("br"),t._v("详见"),s("a",{attrs:{href:"#%E9%87%8D%E6%96%B0%E5%88%B6%E4%BD%9C%E5%BF%AB%E7%85%A7"}},[t._v("“重新制作快照”")]),t._v("章节")])]),t._v(" "),s("tr",[s("td",[t._v("checkoutEveryNms")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("每 N 毫秒重新制作一次全量快照"),s("br"),t._v("详见"),s("a",{attrs:{href:"#%E9%87%8D%E6%96%B0%E5%88%B6%E4%BD%9C%E5%BF%AB%E7%85%A7"}},[t._v("“重新制作快照”")]),t._v("章节")])]),t._v(" "),s("tr",[s("td",[t._v("blockClass")]),t._v(" "),s("td",[t._v("'rr-block'")]),t._v(" "),s("td",[t._v("字符串或正则表达式，可用于自定义屏蔽元素的类名，详见"),s("a",{attrs:{href:"#%E9%9A%90%E7%A7%81"}},[t._v("“隐私”")]),t._v("章节")])]),t._v(" "),s("tr",[s("td",[t._v("blockSelector")]),t._v(" "),s("td",[t._v("null")]),t._v(" "),s("td",[t._v("所有 element.matches(blockSelector)为 true 的元素都不会被录制，回放时取而代之的是一个同等宽高的占位元素")])]),t._v(" "),s("tr",[s("td",[t._v("ignoreClass")]),t._v(" "),s("td",[t._v("'rr-ignore'")]),t._v(" "),s("td",[t._v("字符串或正则表达式，可用于自定义忽略元素的类名，详见"),s("a",{attrs:{href:"#%E9%9A%90%E7%A7%81"}},[t._v("“隐私”")]),t._v("章节")])]),t._v(" "),s("tr",[s("td",[t._v("ignoreCSSAttributes")]),t._v(" "),s("td",[t._v("null")]),t._v(" "),s("td",[t._v("应该被忽略的 CSS 属性数组")])]),t._v(" "),s("tr",[s("td",[t._v("maskTextClass")]),t._v(" "),s("td",[t._v("'rr-mask'")]),t._v(" "),s("td",[t._v("字符串或正则表达式，可用于自定义忽略元素 text 内容的类名，详见"),s("a",{attrs:{href:"#%E9%9A%90%E7%A7%81"}},[t._v("“隐私”")]),t._v("章节")])]),t._v(" "),s("tr",[s("td",[t._v("maskTextSelector")]),t._v(" "),s("td",[t._v("null")]),t._v(" "),s("td",[t._v("所有 element.matches(maskTextSelector)为 true 的元素及其子元素的 text 内容将会被屏蔽")])]),t._v(" "),s("tr",[s("td",[t._v("maskAllInputs")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("将所有输入内容记录为 *")])]),t._v(" "),s("tr",[s("td",[t._v("maskInputOptions")]),t._v(" "),s("td",[t._v("{ password: true }")]),t._v(" "),s("td",[t._v("选择将特定类型的输入框内容记录为 *"),s("br"),t._v("类型详见"),s("a",{attrs:{href:"https://github.com/rrweb-io/rrweb/blob/588164aa12f1d94576f89ae0210b98f6e971c895/packages/rrweb-snapshot/src/types.ts#L77-L95",target:"_blank",rel:"noopener noreferrer"}},[t._v("列表"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("maskInputFn")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("自定义特定类型的输入框内容记录逻辑")])]),t._v(" "),s("tr",[s("td",[t._v("maskTextFn")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("自定义文字内容的记录逻辑")])]),t._v(" "),s("tr",[s("td",[t._v("slimDOMOptions")]),t._v(" "),s("td",[t._v("{}")]),t._v(" "),s("td",[t._v("去除 DOM 中不必要的部分 "),s("br"),t._v("类型详见"),s("a",{attrs:{href:"https://github.com/rrweb-io/rrweb/blob/588164aa12f1d94576f89ae0210b98f6e971c895/packages/rrweb-snapshot/src/types.ts#L97-L108",target:"_blank",rel:"noopener noreferrer"}},[t._v("列表"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("inlineStylesheet")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("是否将样式表内联")])]),t._v(" "),s("tr",[s("td",[t._v("hooks")]),t._v(" "),s("td",[t._v("{}")]),t._v(" "),s("td",[t._v("各类事件的回调"),s("br"),t._v("类型详见"),s("a",{attrs:{href:"https://github.com/rrweb-io/rrweb/blob/9488deb6d54a5f04350c063d942da5e96ab74075/src/types.ts#L207",target:"_blank",rel:"noopener noreferrer"}},[t._v("列表"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("packFn")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("数据压缩函数，详见"),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/optimize-storage.zh_CN.html"}},[t._v("优化存储策略")])],1)]),t._v(" "),s("tr",[s("td",[t._v("sampling")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("数据抽样策略，详见"),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/optimize-storage.zh_CN.html"}},[t._v("优化存储策略")])],1)]),t._v(" "),s("tr",[s("td",[t._v("recordCanvas")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否记录 canvas 内容, 可用选项：false, true")])]),t._v(" "),s("tr",[s("td",[t._v("inlineImages")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否将图片内容记内联录制")])]),t._v(" "),s("tr",[s("td",[t._v("collectFonts")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否记录页面中的字体文件")])]),t._v(" "),s("tr",[s("td",[t._v("userTriggeredOnInput")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://github.com/rrweb-io/rrweb/pull/495",target:"_blank",rel:"noopener noreferrer"}},[t._v("什么是 "),s("code",[t._v("userTriggered")]),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("plugins")]),t._v(" "),s("td",[t._v("[]")]),t._v(" "),s("td",[t._v("加载插件以获得额外的录制功能. "),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/plugin.zh_CN.html"}},[t._v("什么是插件？")])],1)])])]),t._v(" "),s("h4",{attrs:{id:"隐私"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#隐私"}},[t._v("#")]),t._v(" 隐私")]),t._v(" "),s("p",[t._v("页面中可能存在一些隐私相关的内容不希望被录制，rrweb 为此做了以下支持：")]),t._v(" "),s("ul",[s("li",[t._v("在 HTML 元素中添加类名 "),s("code",[t._v(".rr-block")]),t._v(" 将会避免该元素及其子元素被录制，回放时取而代之的是一个同等宽高的占位元素。")]),t._v(" "),s("li",[t._v("在 HTML 元素中添加类名 "),s("code",[t._v(".rr-ignore")]),t._v(" 将会避免录制该元素的输入事件。")]),t._v(" "),s("li",[t._v("所有带有"),s("code",[t._v(".rr-mask")]),t._v("类名的元素及其子元素的 text 内容将会被屏蔽。")]),t._v(" "),s("li",[s("code",[t._v('input[type="password"]')]),t._v(" 类型的密码输入框默认不会录制输入事件。")]),t._v(" "),s("li",[t._v("配置中还有更为丰富的隐私保护选项。")])]),t._v(" "),s("h4",{attrs:{id:"重新制作快照"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重新制作快照"}},[t._v("#")]),t._v(" 重新制作快照")]),t._v(" "),s("p",[t._v("默认情况下，要重放内容需要所有的 event，如果你不想存储所有的 event，可以使用"),s("code",[t._v("checkout")]),t._v("配置。")]),t._v(" "),s("p",[s("strong",[t._v("多数时候你不必这样配置")]),t._v("。但比如在页面错误发生时，你只想捕获最近的几次 event ，这里有一个例子：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用二维数组来存放多个 event 数组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" eventsMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nrrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isCheckout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// isCheckout 是一个标识，告诉你重新制作了快照")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isCheckout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastEvents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    lastEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("checkoutEveryNth")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每 200 个 event 重新制作快照")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向后端传送最新的两个 event 数组")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://YOUR_BACKEND_API'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("由于 rrweb 使用了增量快照机制，我们不能指定数量来捕获最近的几次 event。上面这个例子，你可以拿到最新的 200-400 个 event 来发送给你的后端。")]),t._v(" "),s("p",[t._v("类似的，你可以通过配置 "),s("code",[t._v("checkoutEveryNms")]),t._v(" 来捕获最近指定时间的 event :")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用二维数组来存放多个 event 数组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" eventsMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nrrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isCheckout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// isCheckout 是一个标识，告诉你重新制作了快照")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isCheckout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastEvents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    lastEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("checkoutEveryNms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每5分钟重新制作快照")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向后端传送最新的两个 event 数组")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventsMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("len "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://YOUR_BACKEND_API'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("在上面的例子中，你最终会拿到最新的 5-10 分钟的 event 来发送给你的后端。")]),t._v(" "),s("h3",{attrs:{id:"回放"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回放"}},[t._v("#")]),t._v(" 回放")]),t._v(" "),s("p",[t._v("回放时需要引入对应的 CSS 文件：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.css"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("p",[t._v("再通过以下 JS 代码初始化 replayer：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("YOUR_EVENTS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" replayer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("rrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"使用-api-控制回放"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-api-控制回放"}},[t._v("#")]),t._v(" 使用 API 控制回放")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" replayer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("rrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 播放")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从第 3 秒的内容开始播放")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 暂停")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pause")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 暂停至第 5 秒处")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pause")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 销毁播放器 (提示： 这个操作不可逆)")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("destroy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"配置参数-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置参数-2"}},[t._v("#")]),t._v(" 配置参数")]),t._v(" "),s("p",[t._v("可以通过 "),s("code",[t._v("new rrweb.Replayer(events, options)")]),t._v(" 的方式向 rrweb 传递回放时的配置参数，具体配置如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("key")]),t._v(" "),s("th",[t._v("默认值")]),t._v(" "),s("th",[t._v("功能")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("speed")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("回放倍速")])]),t._v(" "),s("tr",[s("td",[t._v("root")]),t._v(" "),s("td",[t._v("document.body")]),t._v(" "),s("td",[t._v("回放时使用的 HTML 元素")])]),t._v(" "),s("tr",[s("td",[t._v("loadTimeout")]),t._v(" "),s("td",[t._v("0")]),t._v(" "),s("td",[t._v("加载异步样式表的超时时长")])]),t._v(" "),s("tr",[s("td",[t._v("skipInactive")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否快速跳过无用户操作的阶段")])]),t._v(" "),s("tr",[s("td",[t._v("showWarning")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("是否在回放过程中打印警告信息")])]),t._v(" "),s("tr",[s("td",[t._v("showDebug")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否在回放过程中打印 debug 信息")])]),t._v(" "),s("tr",[s("td",[t._v("blockClass")]),t._v(" "),s("td",[t._v("'rr-block'")]),t._v(" "),s("td",[t._v("需要在回放时展示为隐藏区域的元素类名")])]),t._v(" "),s("tr",[s("td",[t._v("liveMode")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("是否开启直播模式")])]),t._v(" "),s("tr",[s("td",[t._v("insertStyleRules")]),t._v(" "),s("td",[t._v("[]")]),t._v(" "),s("td",[t._v("可以传入多个 CSS rule string，用于自定义回放时 iframe 内的样式")])]),t._v(" "),s("tr",[s("td",[t._v("triggerFocus")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("回放时是否回放 focus 交互")])]),t._v(" "),s("tr",[s("td",[t._v("UNSAFE_replayCanvas")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",[t._v("回放时是否回放 canvas 内容，"),s("strong",[t._v("开启后将会关闭沙盒策略，导致一定风险")])])]),t._v(" "),s("tr",[s("td",[t._v("pauseAnimation")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("当播放器停止播放时，是否将 CSS 动画也停止播放")])]),t._v(" "),s("tr",[s("td",[t._v("mouseTail")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("是否在回放时增加鼠标轨迹。传入 false 可关闭，传入对象可以定制轨迹持续时间、样式等，配置详见"),s("a",{attrs:{href:"https://github.com/rrweb-io/rrweb/blob/9488deb6d54a5f04350c063d942da5e96ab74075/src/types.ts#L407",target:"_blank",rel:"noopener noreferrer"}},[t._v("类型"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("unpackFn")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("数据解压缩函数，详见"),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/optimize-storage.zh_CN.html"}},[t._v("优化存储策略")])],1)]),t._v(" "),s("tr",[s("td",[t._v("plugins")]),t._v(" "),s("td",[t._v("[]")]),t._v(" "),s("td",[t._v("加载插件以获得额外的回放功能. "),s("RouterLink",{attrs:{to:"/document/solution/录屏/docs/recipes/plugin.zh_CN.html"}},[t._v("什么是插件？")])],1)]),t._v(" "),s("tr",[s("td",[t._v("useVirtualDom")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("在播放器跳转到一个新的时间点的过程中，是否使用 Virtual Dom 优化")])])])]),t._v(" "),s("h4",{attrs:{id:"使用-rrweb-player"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-rrweb-player"}},[t._v("#")]),t._v(" 使用 rrweb-player")]),t._v(" "),s("p",[t._v("rrweb 自带的回放只提供所有的 JS API 以及最基本的 UI，如果需要功能更强的回放播放器 UI，可以使用 rrweb-player。")]),t._v(" "),s("h5",{attrs:{id:"安装-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[t._v("rrweb-player 同样可以使用 CDN 方式安装：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/style.css"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/index.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("或者通过 npm 安装：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--save")]),t._v(" rrweb-player\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" rrwebPlayer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rrweb-player'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rrweb-player/dist/style.css'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("p",[t._v("通过 props 传入 events 数据及配置项")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("rrwebPlayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以自定义 DOM 元素")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置项")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"配置项参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置项参数"}},[t._v("#")]),t._v(" 配置项参数")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("key")]),t._v(" "),s("th",[t._v("默认值")]),t._v(" "),s("th",[t._v("功能")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("events")]),t._v(" "),s("td",[t._v("[]")]),t._v(" "),s("td",[t._v("包含回放所需的数据")])]),t._v(" "),s("tr",[s("td",[t._v("width")]),t._v(" "),s("td",[t._v("1024")]),t._v(" "),s("td",[t._v("播放器宽度")])]),t._v(" "),s("tr",[s("td",[t._v("height")]),t._v(" "),s("td",[t._v("576")]),t._v(" "),s("td",[t._v("播放器高度")])]),t._v(" "),s("tr",[s("td",[t._v("autoPlay")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("是否自动播放")])]),t._v(" "),s("tr",[s("td",[t._v("speedOption")]),t._v(" "),s("td",[t._v("[1, 2, 4, 8]")]),t._v(" "),s("td",[t._v("倍速播放可选值")])]),t._v(" "),s("tr",[s("td",[t._v("showController")]),t._v(" "),s("td",[t._v("true")]),t._v(" "),s("td",[t._v("是否显示播放器控制 UI")])]),t._v(" "),s("tr",[s("td",[t._v("tags")]),t._v(" "),s("td",[t._v("{}")]),t._v(" "),s("td",[t._v("可以以 key value 的形式展示自定义事件在时间轴上的颜色")])]),t._v(" "),s("tr",[s("td",[t._v("...")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("其它所有 rrweb Replayer 的配置参数均可透传")])])])]),t._v(" "),s("h4",{attrs:{id:"事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件"}},[t._v("#")]),t._v(" 事件")]),t._v(" "),s("p",[t._v("开发者可能希望监听回放时的各类事件，例如在跳过无用户操作的时间时给用户一些提示。")]),t._v(" "),s("p",[t._v("rrweb 的 Replayer 提供了 "),s("code",[t._v("on")]),t._v(" API 用于提供该功能")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" replayer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("rrweb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EVENT_NAME")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("payload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("其包含的事件如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("事件类型")]),t._v(" "),s("th",[t._v("描述")]),t._v(" "),s("th",[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("start")]),t._v(" "),s("td",[t._v("回放开始")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("pause")]),t._v(" "),s("td",[t._v("回放暂停")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("finish")]),t._v(" "),s("td",[t._v("回放完成")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("resize")]),t._v(" "),s("td",[t._v("回放视图大小发生变化")]),t._v(" "),s("td",[t._v("{ width, height }")])]),t._v(" "),s("tr",[s("td",[t._v("fullsnapshot-rebuilded")]),t._v(" "),s("td",[t._v("全量快照完成重建")]),t._v(" "),s("td",[t._v("event")])]),t._v(" "),s("tr",[s("td",[t._v("load-stylesheet-start")]),t._v(" "),s("td",[t._v("开始加载远端样式表")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("load-stylesheet-end")]),t._v(" "),s("td",[t._v("加载远端样式表完成")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("skip-start")]),t._v(" "),s("td",[t._v("开始跳过无用户操作时间")]),t._v(" "),s("td",[t._v("{ speed }")])]),t._v(" "),s("tr",[s("td",[t._v("skip-end")]),t._v(" "),s("td",[t._v("结束无用户操作时间")]),t._v(" "),s("td",[t._v("{ speed }")])]),t._v(" "),s("tr",[s("td",[t._v("mouse-interaction")]),t._v(" "),s("td",[t._v("回放鼠标交互事件")]),t._v(" "),s("td",[t._v("{ type, target }")])]),t._v(" "),s("tr",[s("td",[t._v("event-cast")]),t._v(" "),s("td",[t._v("回放 event")]),t._v(" "),s("td",[t._v("event")])]),t._v(" "),s("tr",[s("td",[t._v("custom-event")]),t._v(" "),s("td",[t._v("回放自定义事件")]),t._v(" "),s("td",[t._v("event")])]),t._v(" "),s("tr",[s("td",[t._v("destroy")]),t._v(" "),s("td",[t._v("销毁播放器")]),t._v(" "),s("td",[t._v("-")])])])]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("rrweb-player")]),t._v(" 时，也可以通过 "),s("code",[t._v("addEventListener")]),t._v(" API 使用相同的事件功能，并且会获得 3 个额外的事件：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("事件类型")]),t._v(" "),s("th",[t._v("描述")]),t._v(" "),s("th",[t._v("值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ui-update-current-time")]),t._v(" "),s("td",[t._v("当前回放时间点")]),t._v(" "),s("td",[t._v("{ payload }")])]),t._v(" "),s("tr",[s("td",[t._v("ui-update-player-state")]),t._v(" "),s("td",[t._v("当前回放状态")]),t._v(" "),s("td",[t._v("{ payload }")])]),t._v(" "),s("tr",[s("td",[t._v("ui-update-progress")]),t._v(" "),s("td",[t._v("当前回放百分比")]),t._v(" "),s("td",[t._v("{ payload }")])])])]),t._v(" "),s("h2",{attrs:{id:"repl-工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#repl-工具"}},[t._v("#")]),t._v(" REPL 工具")]),t._v(" "),s("p",[t._v("在不安装 rrweb 的情况下，也可以通过使用 REPL 工具试用 rrweb 录制 web 应用。")]),t._v(" "),s("p",[t._v("运行 "),s("code",[t._v("yarn repl")]),t._v("，将会启动浏览器并在命令行要求输入一个测试的 url：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Enter the url you want to record, e.g https://react-redux.realworld.io:\n")])])]),s("p",[t._v("输入后等待浏览器打开指定页面，并在命令行中出现以下提示信息：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Enter the url you want to record, e.g https://react-redux.realworld.io: https://github.com\nGoing to open https://github.com...\nReady to record. You can do any interaction on the page.\nOnce you want to finish the recording, enter 'y' to start replay:\n")])])]),s("p",[t._v("此时可以在页面中进行交互，待所需录制操作完成后，在命令行输入 y，测试工具就会将刚刚的操作进行回放，用于验证录制是否成功。")]),t._v(" "),s("p",[t._v("回放时命令行中将出现以下提示信息：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Enter 'y' to persistently store these recorded events:\n")])])]),s("p",[t._v("此时可以再次在命令行中输入 y，测试工具将把已录制的内容存入一个静态 HTML 文件中，并提示存放位置：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Saved at PATH_TO_YOUR_REPO/temp/replay_2018_11_23T07_53_30.html\n")])])]),s("p",[t._v("该文件默认使用最新 bundle 的 rrweb 代码，所以我们可以在修改代码后运行 "),s("code",[t._v("npm run bundle:browser")]),t._v("，之后刷新静态文件就可以查看最新代码对回放的影响并进行调试。")])])}),[],!1,null,null,null);s.default=e.exports}}]);