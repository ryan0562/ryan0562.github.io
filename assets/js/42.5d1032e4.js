(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{506:function(t,a,e){"use strict";e.r(a);var s=e(2),i=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"web端高分屏图片加载方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web端高分屏图片加载方案"}},[t._v("#")]),t._v(" Web端高分屏图片加载方案")]),t._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("随着显示器的快速发展，越来越多的用户更换了高分屏，我们作为Web开发者，网站内的图片尺寸都是适配普通屏幕的，如果在高分屏上图片将会变得模糊不清。")]),t._v(" "),a("p",[t._v("我观察了几个网站，发现他们的做法是直接用了@2x的图片，这种做法在普通屏幕上图片的一些细节会丢失。那么有没有什么办法可以兼顾普通屏幕和高分屏呢？本文就跟大家分享一种解决方案，欢迎各位感兴趣的开发者阅读本文。")]),t._v(" "),a("h2",{attrs:{id:"基础概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础概念"}},[t._v("#")]),t._v(" 基础概念")]),t._v(" "),a("p",[t._v("在前言中，我们提到了"),a("strong",[t._v("高分屏")]),t._v("和**@2x**，本章节就跟大家聊一聊这两个概念。")]),t._v(" "),a("h3",{attrs:{id:"高分屏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高分屏"}},[t._v("#")]),t._v(" 高分屏")]),t._v(" "),a("p",[t._v("高分屏是指高分辨率的显示器，通常情况下我们把大于1080P分辨率的显示器称为高分屏，例如：2k、4k显示器，屏幕分辨率越高，能显示出来的像素点就越多，我们看到的画面也就更细腻。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8ff0434c9ee432185630d84c55cb96f~tplv-k3u1fbpfcp-zoom-1.image",alt:"视频的分辨率"}})]),t._v(" "),a("h3",{attrs:{id:"设备像素比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设备像素比"}},[t._v("#")]),t._v(" 设备像素比")]),t._v(" "),a("p",[t._v("上个章节中，我们讲了高分屏的概念，高分辨率下可以显示更多的像素点，那么操作系统的UI和字体就会变得非常小。")]),t._v(" "),a("p",[t._v("为了解决这个问题，操作系统提供了缩放选项，可以让系统UI看起来跟普通屏一样，但是显示效果更细腻。在macos中，有一个HIDPI的概念，简单来说就是用4个像素渲染1个像素。")]),t._v(" "),a("p",[t._v("如下图所示，我们渲染了圆的1/4，需要4x4个逻辑像素（下图左侧）。如果我们先将画面放大4倍，这个1/4的圆就要对应8x8个逻辑像素了。再将画面渲染到8x8的逻辑像素上（下图中间），最后一一对应的显示到8x8个硬件像素上（下图右侧）。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2217fc9f8f64b4f81839e1154ba6cbf~tplv-k3u1fbpfcp-zoom-1.image",alt:"hidpi-5.png"}})]),t._v(" "),a("p",[t._v("我们用8x8个硬件像素来渲染一个四分之一的圆，圆的面积依然没有发生改变，但是轮廓处虚化像素的数量变少了、圆的边缘显得更锐利了，肉眼看起来也就更清晰了。")]),t._v(" "),a("p",[t._v("4x4个逻辑像素用8x8个硬件像素来渲染，刚好扩大了2倍，我们把这个比例称为：设备像素比，可以通过"),a("code",[t._v("window.devicePixelRatio")]),t._v("来获取。高分屏上获取到的值就是2，普通屏上获取到的值就是1。因此，我们就需要准备2个尺寸的图片，分别针对普通屏和高分屏。设备像素比是2，我们的图片命名后缀就可以用"),a("code",[t._v("@2x")]),t._v("来标识。")]),t._v(" "),a("blockquote",[a("p",[t._v("本文只粗略的讲一下HIDPI，想更进一步了解的开发者请移步："),a("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fblog.skk.moe%2Fpost%2Fhidpi-what-why-how%2F",title:"https://blog.skk.moe/post/hidpi-what-why-how/",target:"_blank",rel:"noopener noreferrer"}},[t._v("谈谈 HiDPI —— 是什么，为什么，怎么做"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),a("p",[t._v("在web端我们要显示一个图片有两种方式："),a("code",[t._v("img")]),t._v("标签、"),a("code",[t._v("background-image")]),t._v("属性。")]),t._v(" "),a("h3",{attrs:{id:"img标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#img标签"}},[t._v("#")]),t._v(" img标签")]),t._v(" "),a("p",[t._v("大多数情况下，我们显示一个图片会用src属性，如下所示。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<img src="img/more.png" alt="" style="width: 18px; height: 18px">\n复制代码\n')])])]),a("p",[t._v("在普通屏幕上这个图片看起来很正常，但是在高分屏上就会有些模糊。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec182bd66e064e69b45026bcab42e689~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720220139981"}})]),t._v(" "),a("p",[t._v("我的设备像素比是2，因此我把图片的尺寸扩大2倍，显示出来的效果就是正常的。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<img src="img/more@2x.png" alt="" style="width: 18px; height: 18px" >\n复制代码\n')])])]),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/107d8cb254b34540a7d09f8f045e6344~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720220403314"}})]),t._v(" "),a("p",[t._v("如果都用@2x的图片，会造成额外的带宽消耗。有没有什么方法能做到动态加载呢（高分屏用@2x，普通屏用正常图片）？")]),t._v(" "),a("p",[t._v("经过一番查找后，发现img标签有一个名为"),a("code",[t._v("srcset")]),t._v("的属性，它的用法如下所示：")]),t._v(" "),a("ul",[a("li",[t._v("不同尺寸的图片用逗号隔开")]),t._v(" "),a("li",[t._v("每个尺寸的图片路径后跟一个空格写设备像素比（1x、2x）")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<img src="img/more.png" alt="" style="width: 18px; height: 18px" srcset="img/more.png 1x,img/more@2x.png 2x">\n复制代码\n')])])]),a("p",[t._v("这样子写了后，浏览器会根据当前屏幕的设备像素比，自动选择要加载的图片，如下所示")]),t._v(" "),a("ul",[a("li",[t._v("普通屏加载1x的图片")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4271100741a84449a35958a1f777955e~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720223135753"}})]),t._v(" "),a("ul",[a("li",[t._v("高分屏加载2x的图片")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32bf93797b934d3eb924dc9ebe82c122~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720222819149"}})]),t._v(" "),a("h3",{attrs:{id:"background-image属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background-image属性"}},[t._v("#")]),t._v(" background-image属性")]),t._v(" "),a("p",[t._v("css的"),a("strong",[t._v("background-image")]),t._v("属性也可以用来显示一张图片，它提供了"),a("code",[t._v("image-set()")]),t._v("方法，会根据当前屏幕的设备像素比，自动选择要加载的图片。它的用法如下所示：")]),t._v(" "),a("ul",[a("li",[t._v("image-set方法内部用url来加载图片路径")]),t._v(" "),a("li",[t._v("url方法后跟一个空格写设备像素比（1x、2x）")]),t._v(" "),a("li",[a("code",[t._v("-webkit-")]),t._v("为兼容写法")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<style>\n        .img-panel {\n            width: 18px;\n            height: 18px;\n            background-image: image-set(url(./img/more.png) 1x, url(./img/more@2x.png) 2x);\n            background-image: -webkit-image-set(url(./img/more.png) 1x, url(./img/more@2x.png) 2x);\n        }\n    </style>\n\n<body>\n    <div class="img-panel"></div>\n</body>\n复制代码\n')])])]),a("p",[t._v("同样的，浏览器会根据设备像素比选择合适的图片来加载。")]),t._v(" "),a("ul",[a("li",[t._v("普通屏加载1x的图片")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a834477b29a7457197adc8b111e28a9c~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720225444753"}})]),t._v(" "),a("ul",[a("li",[t._v("高分屏加载2x的图片")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7180beb9c54b446db92673b0dbab63d3~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20220720225208927"}})])])}),[],!1,null,null,null);a.default=i.exports}}]);