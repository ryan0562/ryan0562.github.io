<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>换肤实现方案 | wk-ui</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="王先生的小屋">
    
    <link rel="preload" href="/assets/css/0.styles.4c3c4448.css" as="style"><link rel="preload" href="/assets/js/app.7cf3608a.js" as="script"><link rel="preload" href="/assets/js/3.5f8bd7e7.js" as="script"><link rel="preload" href="/assets/js/39.dd3f5468.js" as="script"><link rel="prefetch" href="/assets/js/10.107ffebe.js"><link rel="prefetch" href="/assets/js/11.02547514.js"><link rel="prefetch" href="/assets/js/12.3ab178b4.js"><link rel="prefetch" href="/assets/js/13.c7730d6e.js"><link rel="prefetch" href="/assets/js/14.36e75848.js"><link rel="prefetch" href="/assets/js/15.7fcada81.js"><link rel="prefetch" href="/assets/js/16.26182406.js"><link rel="prefetch" href="/assets/js/17.3f4c958f.js"><link rel="prefetch" href="/assets/js/18.00901620.js"><link rel="prefetch" href="/assets/js/19.98fa63bb.js"><link rel="prefetch" href="/assets/js/2.721bff91.js"><link rel="prefetch" href="/assets/js/20.5352f3e4.js"><link rel="prefetch" href="/assets/js/21.57af2441.js"><link rel="prefetch" href="/assets/js/22.e1144acb.js"><link rel="prefetch" href="/assets/js/23.1097d1ca.js"><link rel="prefetch" href="/assets/js/24.c938c047.js"><link rel="prefetch" href="/assets/js/25.9ad5d079.js"><link rel="prefetch" href="/assets/js/26.b0cd0737.js"><link rel="prefetch" href="/assets/js/27.c3a03ad0.js"><link rel="prefetch" href="/assets/js/28.61ec617a.js"><link rel="prefetch" href="/assets/js/29.60c239df.js"><link rel="prefetch" href="/assets/js/30.d90c4c2f.js"><link rel="prefetch" href="/assets/js/31.83bf1c77.js"><link rel="prefetch" href="/assets/js/32.1d876505.js"><link rel="prefetch" href="/assets/js/33.4fe73c76.js"><link rel="prefetch" href="/assets/js/34.e0d1c8ba.js"><link rel="prefetch" href="/assets/js/35.2be665e5.js"><link rel="prefetch" href="/assets/js/36.42f2ff47.js"><link rel="prefetch" href="/assets/js/37.129ad49b.js"><link rel="prefetch" href="/assets/js/38.25995eaa.js"><link rel="prefetch" href="/assets/js/4.86facec4.js"><link rel="prefetch" href="/assets/js/40.d8f7cebc.js"><link rel="prefetch" href="/assets/js/41.0cf108b4.js"><link rel="prefetch" href="/assets/js/42.84b15d33.js"><link rel="prefetch" href="/assets/js/43.4f6b39a8.js"><link rel="prefetch" href="/assets/js/44.a8fa8ab7.js"><link rel="prefetch" href="/assets/js/45.93086370.js"><link rel="prefetch" href="/assets/js/46.ffc96140.js"><link rel="prefetch" href="/assets/js/47.23458701.js"><link rel="prefetch" href="/assets/js/48.0548f774.js"><link rel="prefetch" href="/assets/js/49.d0f56771.js"><link rel="prefetch" href="/assets/js/5.2ceaec30.js"><link rel="prefetch" href="/assets/js/50.c6eec1d8.js"><link rel="prefetch" href="/assets/js/6.9bbbd3a5.js"><link rel="prefetch" href="/assets/js/7.7e7cdaa0.js"><link rel="prefetch" href="/assets/js/8.f90dff4c.js"><link rel="prefetch" href="/assets/js/9.8cb5c97b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4c3c4448.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">wk-ui</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/document/form/dialog.html" class="nav-link">
  组件文档
</a></div><div class="nav-item"><a href="/document/directive/permission.html" class="nav-link">
  指令
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          git
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/tools/git/git-ssh.html" class="nav-link">
  git解决方案
</a></li></ul></li><li class="dropdown-item"><h4>
          npm
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/tools/npm/nrm.html" class="nav-link">
  nrm换源
</a></li><li class="dropdown-subitem"><a href="/document/tools/npm/changeOrigin.html" class="nav-link">
  npm手动换源
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="阅读" class="dropdown-title"><span class="title">阅读</span> <span class="arrow down"></span></button> <button type="button" aria-label="阅读" class="mobile-dropdown-title"><span class="title">阅读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/read/正面教育.html" class="nav-link">
  正面教育
</a></li></ul></div></div><div class="nav-item"><a href="/document/skill/skill.html" class="nav-link">
  开发技巧
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="utils" class="dropdown-title"><span class="title">utils</span> <span class="arrow down"></span></button> <button type="button" aria-label="utils" class="mobile-dropdown-title"><span class="title">utils</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/utils/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/媒体.html" class="nav-link">
  媒体
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/数据类型操作.html" class="nav-link">
  数据类型操作
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/时间操作.html" class="nav-link">
  时间操作
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/空间、坐标、地理.html" class="nav-link">
  空间、坐标、地理
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/设备、环境、功能支持.html" class="nav-link">
  设备、环境、功能支持
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="solution" class="dropdown-title"><span class="title">solution</span> <span class="arrow down"></span></button> <button type="button" aria-label="solution" class="mobile-dropdown-title"><span class="title">solution</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/solution/微前端/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/夸页面通信/夸页面通信.html" class="nav-link">
  夸页面通信
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/换肤/换肤.html" class="nav-link">
  换肤
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/大屏模块化/介绍.html" class="nav-link">
  大屏设计器
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/高分辨率图片加载/高分辨率图片加载.html" class="nav-link">
  高分辨率图片加载
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/录屏/录屏.html" class="nav-link">
  录屏
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="play" class="dropdown-title"><span class="title">play</span> <span class="arrow down"></span></button> <button type="button" aria-label="play" class="mobile-dropdown-title"><span class="title">play</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/play/autoSendEmail/autoSendEmail.html" class="nav-link">
  自动发送邮件
</a></li></ul></div></div><div class="nav-item"><a href="/document/openai/openai.html" class="nav-link">
  openai
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/document/form/dialog.html" class="nav-link">
  组件文档
</a></div><div class="nav-item"><a href="/document/directive/permission.html" class="nav-link">
  指令
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          git
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/tools/git/git-ssh.html" class="nav-link">
  git解决方案
</a></li></ul></li><li class="dropdown-item"><h4>
          npm
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/tools/npm/nrm.html" class="nav-link">
  nrm换源
</a></li><li class="dropdown-subitem"><a href="/document/tools/npm/changeOrigin.html" class="nav-link">
  npm手动换源
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="阅读" class="dropdown-title"><span class="title">阅读</span> <span class="arrow down"></span></button> <button type="button" aria-label="阅读" class="mobile-dropdown-title"><span class="title">阅读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/read/正面教育.html" class="nav-link">
  正面教育
</a></li></ul></div></div><div class="nav-item"><a href="/document/skill/skill.html" class="nav-link">
  开发技巧
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="utils" class="dropdown-title"><span class="title">utils</span> <span class="arrow down"></span></button> <button type="button" aria-label="utils" class="mobile-dropdown-title"><span class="title">utils</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/utils/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/媒体.html" class="nav-link">
  媒体
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/数据类型操作.html" class="nav-link">
  数据类型操作
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/时间操作.html" class="nav-link">
  时间操作
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/空间、坐标、地理.html" class="nav-link">
  空间、坐标、地理
</a></li><li class="dropdown-item"><!----> <a href="/document/utils/设备、环境、功能支持.html" class="nav-link">
  设备、环境、功能支持
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="solution" class="dropdown-title"><span class="title">solution</span> <span class="arrow down"></span></button> <button type="button" aria-label="solution" class="mobile-dropdown-title"><span class="title">solution</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/solution/微前端/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/夸页面通信/夸页面通信.html" class="nav-link">
  夸页面通信
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/换肤/换肤.html" class="nav-link">
  换肤
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/大屏模块化/介绍.html" class="nav-link">
  大屏设计器
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/高分辨率图片加载/高分辨率图片加载.html" class="nav-link">
  高分辨率图片加载
</a></li><li class="dropdown-item"><!----> <a href="/document/solution/录屏/录屏.html" class="nav-link">
  录屏
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="play" class="dropdown-title"><span class="title">play</span> <span class="arrow down"></span></button> <button type="button" aria-label="play" class="mobile-dropdown-title"><span class="title">play</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/play/autoSendEmail/autoSendEmail.html" class="nav-link">
  自动发送邮件
</a></li></ul></div></div><div class="nav-item"><a href="/document/openai/openai.html" class="nav-link">
  openai
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/document/solution/换肤/换肤.html" class="active sidebar-link">换肤</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/solution/换肤/换肤.html#多套css样式实现" class="sidebar-link">多套CSS样式实现</a></li><li class="sidebar-sub-header"><a href="/document/solution/换肤/换肤.html#css变量实现" class="sidebar-link">CSS变量实现</a></li><li class="sidebar-sub-header"><a href="/document/solution/换肤/换肤.html#sass-less变量实现" class="sidebar-link">Sass/Less变量实现</a></li><li class="sidebar-sub-header"><a href="/document/solution/换肤/换肤.html#动态style实现" class="sidebar-link">动态Style实现</a></li><li class="sidebar-sub-header"><a href="/document/solution/换肤/换肤.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/document/solution/换肤/element-ui同步换肤.html" class="sidebar-link">element-ui同步换肤</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/solution/换肤/element-ui同步换肤.html#使用scss修改变量" class="sidebar-link">使用scss修改变量</a></li><li class="sidebar-sub-header"><a href="/document/solution/换肤/element-ui同步换肤.html#动态link换肤" class="sidebar-link">动态link换肤</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="换肤实现方案"><a href="#换肤实现方案" class="header-anchor">#</a> 换肤实现方案</h1> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa1fd2c1fb264588bcd6ae11400d23df~tplv-k3u1fbpfcp-zoom-1.image" alt="前端暗色模式/换肤实现方案"></p> <h2 id="多套css样式实现"><a href="#多套css样式实现" class="header-anchor">#</a> 多套CSS样式实现</h2> <p>通过编写多套CSS样式代码来实现，切换功能就通过动态修改<code>link</code>标签的<code>href</code>或者动态添加删除<code>link</code>标签。这方案就不贴代码了......</p> <p>优点：简单</p> <p>缺点：维护成本高</p> <h2 id="css变量实现"><a href="#css变量实现" class="header-anchor">#</a> CSS变量实现</h2> <p>在CSS里面定义颜色，字体，宽高等变量，通过使用这些变量来实现换肤功能，核心就是切换属性/类名来切换颜色值。</p> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FAsaki-M%2Fpractice%2Ftree%2Fmain%2Fprofession%2FtoggleTheme%2Fcss-variable" title="https://github.com/Asaki-M/practice/tree/main/profession/toggleTheme/css-variable" target="_blank" rel="noopener noreferrer">项目源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下面贴出代码展示：</p> <p>html结构如下：<code>main</code>标签里面是内容，上面的<code>div</code>是用来切换皮肤的</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;body&gt;
  &lt;div&gt;
    &lt;!-- 这里是切换的按钮 --&gt;
    &lt;img src=&quot;../icons/sum.svg&quot; id=&quot;theme&quot;&gt;
  &lt;/div&gt;
  &lt;main class=&quot;content&quot;&gt;
    &lt;h1&gt;CSS variable&lt;/h1&gt;
    &lt;p&gt;abcdefghijklmnopqrstuvwxyz,abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
    &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
    &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
    &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
    &lt;button&gt;button&lt;/button&gt;
  &lt;/main&gt;
&lt;/body&gt;
复制代码
</code></pre></div><p>css代码如下：当前是使用给<code>Body</code>添加类名的方式来实现切换，定义变量</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- 默认值 --&gt;
:root {
  --bg-color-0: #fff;
  --bg-color-1: #fff;
  --text-color: #333;
  --grey-1: #1c1f23;
}

&lt;!-- 使用 data-theme 属性 --&gt;
[data-theme='dark'] {
  --bg-color-1: #35363c;
}

&lt;!-- 使用css --&gt;
:root .dark {
  --bg-color-0: #16161a;
  --bg-color-1: #35363c;
  --text-color: #fff;
  --grey-1: #f9f9f9;
}
复制代码
</code></pre></div><p>使用定义的变量：通过<code>var(param)</code>使用</p> <div class="language- extra-class"><pre class="language-text"><code>body {
  margin: 0;
  padding: 0;
  background-color: var(--bg-color-0);
  transition: all 0.3s;
}

.content {
  padding: 20px;
  background-color: var(--bg-color-1);
  color: var(--text-color);
}

.content button {
  width: 100px;
  height: 30px;
  background-color: var(--bg-color-1);
  color: var(--text-color);
  border: 1px solid var(--grey-1);
  outline: none;
}
复制代码
</code></pre></div><p>通过js来对切换按钮进行一个给<code>Body</code>增加/删除类名的操作。</p> <div class="language- extra-class"><pre class="language-text"><code> const themebtn = document.getElementById('theme')
  themebtn.addEventListener('click', () =&gt; {
    const body = document.body
    // 判断当前是否是黑夜模式，从而切换模式
    if (Array.from(body.classList).indexOf('dark') !== -1) {
      body.classList.remove('dark')
      themebtn.src = '../icons/sum.svg'
    } else {
      body.classList.add('dark')
      themebtn.src = '../icons/moon.svg'
    }
  })
复制代码
</code></pre></div><p>效果图：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6719c20cb0c4c70a270c7f10e2ef349~tplv-k3u1fbpfcp-zoom-1.image" alt="1647849164(1).jpg"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b14d71f731c42c0b2dfbf4e9658f43d~tplv-k3u1fbpfcp-zoom-1.image" alt="1647849516(1).jpg"></p> <p>这种方式实现的一个优缺点</p> <p>优点：简单易懂</p> <p>缺点：存在兼容性问题，IE不支持，解决方法也有就是使用<a href="https://link.juejin.cn/?target=https%3A%2F%2Fjhildenbiddle.github.io%2Fcss-vars-ponyfill%2F%23%2F" title="https://jhildenbiddle.github.io/css-vars-ponyfill/#/" target="_blank" rel="noopener noreferrer">css-vars-ponyfill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>A <a href="https://link.juejin.cn/?target=https%3A%2F%2Fponyfill.com%2F" title="https://ponyfill.com/" target="_blank" rel="noopener noreferrer">ponyfill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that provides client-side support for <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2F--*" title="https://developer.mozilla.org/en-US/docs/Web/CSS/--*" target="_blank" rel="noopener noreferrer">CSS custom properties<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (aka “CSS variables”) in legacy and modern browsers.</p> <p>在旧版和现代浏览器中为 CSS 自定义属性（又称“CSS 变量”）提供客户端支持的 ponyfill。</p></blockquote> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2FUsing_CSS_custom_properties%23browser_compatibility" title="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties#browser_compatibility" target="_blank" rel="noopener noreferrer">css变量兼容性-MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="sass-less变量实现"><a href="#sass-less变量实现" class="header-anchor">#</a> Sass/Less变量实现</h2> <p>实现方法跟用CSS变量差不多，也是通过给根元素添加属性/类名来达成切换的效果</p> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FAsaki-M%2Fpractice%2Ftree%2Fmain%2Fprofession%2FtoggleTheme%2Fscss-variable" title="https://github.com/Asaki-M/practice/tree/main/profession/toggleTheme/scss-variable" target="_blank" rel="noopener noreferrer">项目源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>简单的搭建一个React + SCSS的项目来实现，文件目录如下，主要看<code>_variable.scss</code>和<code>_handle.scss</code>两个文件</p> <div class="language- extra-class"><pre class="language-text"><code>scss-variable
├── yarn.lock
├── package.json
├── public
│   └── index.html
├── src
│   ├── index.scss
│   ├── _variable.scss
│   ├── _handle.scss
│   ├── index.js
│   └── app.jsx
└── webpack.config.js
复制代码
</code></pre></div><p>首先看<code>app.jsx</code>文件，里面编写了页面结构以及切换的逻辑</p> <div class="language- extra-class"><pre class="language-text"><code>import { useCallback, useState } from 'react'
import './index.scss'
const App = () =&gt; {
  // 定义切换按钮的文案，并且给html附上默认主题类型
  const [themeText, setThemeText] = useState(() =&gt; {
    document.documentElement.setAttribute('data-theme', 'light')
    return 'light'
  })
  // 切换逻辑
  const toggleTheme = useCallback(() =&gt; {
    if (themeText === 'light') {
      document.documentElement.setAttribute('data-theme', 'dark')
      setThemeText('dark')
    } else {
      document.documentElement.setAttribute('data-theme', 'light')
      setThemeText('light')
    }
  })
  return (
    &lt;div className=&quot;content&quot;&gt;
      &lt;button onClick={toggleTheme}&gt;{themeText}&lt;/button&gt;
      &lt;h1&gt;SCSS variable&lt;/h1&gt;
      &lt;p&gt;abcdefghijklmnopqrstuvwxyz,abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
      &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
      &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
      &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
      &lt;button&gt;button&lt;/button&gt;
    &lt;/div&gt;
  )
}

export default App
复制代码
</code></pre></div><p>然后就是<code>_variable.scss</code>和<code>_handle.scss</code></p> <p><code>_variable.scss</code>：定义每个主题的变量</p> <div class="language- extra-class"><pre class="language-text"><code>$themes: (
    light: (
        bg-color-0: #fff,
        bg-color-1: #fff,
        text-color: #333,
        grey-1: #1c1f23
    ),
    dark: (
        bg-color-0: #16161a,
        bg-color-1: #35363c,
        text-color: #fff,
        grey-1: #f9f9f9
    )
);
复制代码
</code></pre></div><p><code>_handle.scss</code>：定义mixin来将每个主题的对应颜色字体宽高等等绑定好，只要根据某个mixin来传入对应的key值就好</p> <div class="language- extra-class"><pre class="language-text"><code>@mixin themeify {

  // 遍历_variable.scss定义的主题
  @each $theme-name,
  $theme-map in $themes {
    // 将每个主题提升为全局变量
    $theme-map: $theme-map !global;

    // 绑定某个主题下的样式内容
    [data-theme=&quot;#{$theme-name}&quot;] &amp; {
      @content
    }
  }
}

// 定义一个通过key获取主题变量的值函数
@function themed($key) {
  @return map-get($theme-map, $key)
}

// 下面这些mixin绑定在那个主题就那种颜色
@mixin bgColor($color) {
  @include themeify {
    background-color: themed($color);
  }
}

@mixin textColor($color) {
  @include themeify {
    color: themed($color);
  }
}

@mixin borderColor($color) {
  @include themeify {
    border-color: themed($color);
  }
}
复制代码
</code></pre></div><p>这里我是已经将<code>_variable.scss</code>和<code>_handle.scss</code>两个文件在webpack里面配置了全局引入了，所以能在<code>index.scss</code>里面使用 <code>index.scss</code>：使用mixin来绑定</p> <div class="language- extra-class"><pre class="language-text"><code>body {
  margin: 0;
  padding: 0;
  transition: all 0.3s;
  @include bgColor('bg-color-0');
}

.content {
  padding: 20px;
  @include bgColor('bg-color-1');
  @include textColor('text-color');


  button {
    width: 100px;
    height: 30px;
    border: 1px solid;
    outline: none;
    @include bgColor('bg-color-0');
    @include borderColor('grey-1');
    @include textColor('text-color');

  }
}
复制代码
</code></pre></div><p>效果跟CSS变量一致</p> <p>优点：因为使用webpack进行打包，所以兼容性问题可以解决</p> <p>缺点：代码可读性不如CSS强</p> <h2 id="动态style实现"><a href="#动态style实现" class="header-anchor">#</a> 动态Style实现</h2> <p>这种核心原理就是通过给<code>style</code>标签里面的内容进行更改来实现，这种方案是参考了<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FElemeFE%2Felement%2Fissues%2F3054" title="https://github.com/ElemeFE/element/issues/3054" target="_blank" rel="noopener noreferrer">ElementUI的换肤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来实现。<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FElementUI%2Ftheme-preview" title="https://github.com/ElementUI/theme-preview" target="_blank" rel="noopener noreferrer">ElementUI换肤DEMO的仓库地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FAsaki-M%2Fpractice%2Ftree%2Fmain%2Fprofession%2FtoggleTheme%2Fstyle-override" title="https://github.com/Asaki-M/practice/tree/main/profession/toggleTheme/style-override" target="_blank" rel="noopener noreferrer">项目源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参照着实现：原理就是读取CSS文件里面的样式，通过把颜色替换成关键字，再选择一种颜色将关键字再次替换，将关键字再将样式通过<code>style</code>标签插入DOM里面。</p> <p>目录文件：<code>formula.json</code>编写颜色，<code>color.js</code>编写颜色转换的逻辑。</p> <div class="language- extra-class"><pre class="language-text"><code>style-override
├── yarn.lock
├── package.json
├── public
│   └── index.html
├── src
│   ├── color.js
│   ├── formula.json
│   ├── index.js
│   └── app.jsx
└── webpack.config.js
复制代码
</code></pre></div><p><code>formula.json</code>文件定义颜色与关键字之间的对应关系，这里是用到<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fcss-color-function" title="https://www.npmjs.com/package/css-color-function" target="_blank" rel="noopener noreferrer">css-color-function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的插件所以写成这样。</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;bgColor0&quot;: &quot;color(primary contrast(50%))&quot;,
  &quot;bgColor1&quot;: &quot;color(primary contrast(50%))&quot;,
  &quot;textColor&quot;: &quot;color(primary tint(50%))&quot;,
  &quot;grey1&quot;: &quot;color(primary tint(50%))&quot;
}
复制代码
</code></pre></div><p><code>color.js</code>文件：通过<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fcss-color-function" title="https://www.npmjs.com/package/css-color-function" target="_blank" rel="noopener noreferrer">css-color-function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>将颜色替换到json里面的关键字，并且返回colors对象。</p> <div class="language- extra-class"><pre class="language-text"><code>import color from 'css-color-function'
import formula from './formula.json'
const generateColors = (primary) =&gt; {
  let colors = {}
  // 遍历formula里面的value，将关键字通过css-color-function换成rgb颜色
  Object.keys(formula).forEach((key) =&gt; {
    const value = formula[key].replace(/primary/g, primary)
    // css-color-function提供的convert转换颜色
    colors[key] = color.convert(value)
  })

  return colors
}
export default generateColors
复制代码
</code></pre></div><p><code>app.jsx</code>文件拆分讲解，页面结构如下：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;div className=&quot;content&quot;&gt;
  &lt;input type=&quot;color&quot; onChange={toggleTheme} /&gt;
  &lt;h1&gt;CSS variable&lt;/h1&gt;
  &lt;p&gt;abcdefghijklmnopqrstuvwxyz,abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
  &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
  &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
  &lt;p&gt;abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
  &lt;button&gt;button&lt;/button&gt;
&lt;/div&gt;
复制代码
</code></pre></div><p>等组件一渲染就通过fetch发请求来读取CSS文件，然后将颜色转换成关键字，最后生成一个CSS模板。</p> <div class="language- extra-class"><pre class="language-text"><code>const [styleTemplate, setStyleTemplate] = useState('')
useEffect(() =&gt; {
const colorMap = {
  '#fff': 'bgColor0',
  '#fff': 'bgColor1',
  '#333': 'textColor',
  '#1c1f23': 'grey1'
}
fetch('https://assets.asaki-m.com/template.css')
  .then((r) =&gt; r.text())
  .then((data) =&gt; {
    let dataText = data
    // 遍历颜色映射表将颜色转换成关键字
    Object.keys(colorMap).forEach((key) =&gt; {
      const value = colorMap[key]
      dataText = dataText.replace(new RegExp(key, 'ig'), value)
    })
    // 转换完后设置到变量保存模板
    setStyleTemplate(dataText)
  })
}, [])
复制代码
</code></pre></div><p>颜色选择器选择一个颜色后，根据css模板来修改或生成style标签。</p> <div class="language- extra-class"><pre class="language-text"><code>const originalStylesheetCount = document.styleSheets.length
const toggleTheme = useCallback((evt) =&gt; {
    let cssText = styleTemplate
    // 通过input color选择完颜色后，生成关键字与颜色对应的映射
    let colors = generateColors(evt.target.value)
    // 遍历映射表重新将关键字替换成rgb颜色
    Object.keys(colors).forEach((key) =&gt; {
      cssText = cssText.replace(
        new RegExp('(:|\s+)' + key, 'g'),
        '$1' + colors[key]
      )
    })
    // 判断是否已经存在了style标签，不存在就创建一个，存在就直接覆盖里面的内容
    if (originalStylesheetCount === document.styleSheets.length) {
      const style = document.createElement('style')
      style.innerText = cssText
      document.head.appendChild(style)
    } else {
      document.head.lastChild.innerText = cssText
    }
})
复制代码
</code></pre></div><p>优点：兼容性问题解决</p> <p>缺点：上手难度高，维护成本高</p> <p>效果图：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30f3f27e6d13448ca139205ffad64767~tplv-k3u1fbpfcp-zoom-1.image" alt="1647863592(1).jpg"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b17736cda6546298bca05715e08c186~tplv-k3u1fbpfcp-zoom-1.image" alt="1647863615(1).jpg"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ee296a5382a4a0cae14bc7a61b162ce~tplv-k3u1fbpfcp-zoom-1.image" alt="1647863633(1).jpg"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>总结下来其实就是给根节点添加自定义主题属性/类名，多写几套主题样式，动态生成/修改style。每一种都有自身的缺点，具体使用根据自身条件以及场景使用即可。</p> <p>上面实现的几种方案都没有做持久化，想要做持久化需要将对应的主题保存到本地缓存里面，然后每次渲染读取缓存的主题，在做一次渲染，并且切换的时候记得修改缓存的主题即可。</p> <p>当然如果有更好的方案也欢迎指出。</p> <p><a href="https://juejin.cn/post/7063010855167721486" target="_blank" rel="noopener noreferrer">转载于掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/document/solution/换肤/element-ui同步换肤.html">
        element-ui同步换肤
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7cf3608a.js" defer></script><script src="/assets/js/3.5f8bd7e7.js" defer></script><script src="/assets/js/39.dd3f5468.js" defer></script>
  </body>
</html>
